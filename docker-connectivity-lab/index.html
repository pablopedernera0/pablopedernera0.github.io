<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab Docker - Diagn√≥stico de Redes</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            width: 100%;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .progress-bar {
            background: rgba(255, 255, 255, 0.2);
            height: 8px;
            border-radius: 4px;
            margin-top: 20px;
            overflow: hidden;
        }

        .progress-fill {
            background: #48bb78;
            height: 100%;
            transition: width 0.3s ease;
        }

        .slide-container {
            padding: 40px;
            min-height: 500px;
        }

        .slide {
            display: none;
            animation: fadeIn 0.5s;
        }

        .slide.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .problem-title {
            color: #e53e3e;
            font-size: 24px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .diagnostic-title {
            color: #3182ce;
            font-size: 24px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .code-block {
            background: #2d3748;
            color: #68d391;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
            font-size: 14px;
            line-height: 1.6;
        }

        .command {
            color: #ffd700;
        }

        .step {
            background: #f7fafc;
            padding: 20px;
            border-left: 4px solid #3182ce;
            margin: 15px 0;
            border-radius: 4px;
        }

        .step h3 {
            color: #2d3748;
            margin-bottom: 10px;
            font-size: 18px;
        }

        .step p {
            color: #4a5568;
            line-height: 1.6;
        }

        .questions {
            background: #fff5e6;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #f6ad55;
        }

        .questions h3 {
            color: #c05621;
            margin-bottom: 15px;
        }

        .questions ul {
            list-style: none;
            padding-left: 0;
        }

        .questions li {
            color: #744210;
            margin: 8px 0;
            padding-left: 25px;
            position: relative;
        }

        .questions li:before {
            content: "‚ùì";
            position: absolute;
            left: 0;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            gap: 15px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }

        .btn-prev {
            background: #e2e8f0;
            color: #2d3748;
        }

        .btn-prev:hover:not(:disabled) {
            background: #cbd5e0;
            transform: translateX(-3px);
        }

        .btn-next {
            background: #4299e1;
            color: white;
            flex: 1;
        }

        .btn-next:hover:not(:disabled) {
            background: #3182ce;
            transform: translateX(3px);
        }

        .btn-solve {
            background: #48bb78;
            color: white;
            flex: 1;
        }

        .btn-solve:hover {
            background: #38a169;
            transform: scale(1.05);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            animation: fadeIn 0.3s;
        }

        .modal.active {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 15px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            animation: slideUp 0.3s;
        }

        @keyframes slideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e2e8f0;
        }

        .modal-header h2 {
            color: #2d3748;
            font-size: 24px;
        }

        .input-group {
            margin: 20px 0;
        }

        .input-group label {
            display: block;
            color: #2d3748;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .input-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            transition: border 0.3s;
        }

        .input-group input:focus {
            outline: none;
            border-color: #4299e1;
        }

        .hints {
            background: #fef5e7;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #f39c12;
        }

        .hints h4 {
            color: #d68910;
            margin-bottom: 10px;
        }

        .hints p {
            color: #7d6608;
            font-size: 14px;
            line-height: 1.6;
        }

        .solution-content {
            margin-top: 25px;
        }

        .solution-content h3 {
            color: #2d3748;
            margin-bottom: 15px;
        }

        .solution-content p {
            color: #4a5568;
            line-height: 1.8;
            margin-bottom: 15px;
        }

        .success-badge {
            display: inline-block;
            background: #c6f6d5;
            color: #22543d;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            margin-top: 10px;
        }

        .error-message {
            background: #fed7d7;
            color: #c53030;
            padding: 12px;
            border-radius: 8px;
            margin-top: 10px;
            display: none;
        }

        .error-message.show {
            display: block;
            animation: shake 0.5s;
        }

        @keyframes shake {
            0%, 100% {
                transform: translateX(0);
            }
            25% {
                transform: translateX(-10px);
            }
            75% {
                transform: translateX(10px);
            }
        }

        .completion {
            text-align: center;
            padding: 40px 20px;
        }

        .completion h2 {
            color: #2d3748;
            font-size: 32px;
            margin-bottom: 20px;
        }

        .completion p {
            color: #4a5568;
            font-size: 18px;
            line-height: 1.8;
        }

        .emoji {
            font-size: 48px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1>üê≥ Laboratorio Docker: Diagn√≥stico de Conectividad</h1>
        <p style="margin-top: 10px; opacity: 0.9;">Diagnostica y soluciona problemas de red entre contenedores</p>
        <div class="progress-bar">
            <div class="progress-fill" id="progressBar"></div>
        </div>
    </div>

    <div class="slide-container" id="slideContainer">
        <!-- Slide 0: Introducci√≥n -->
        <div class="slide active">
            <div style="text-align: center; padding: 20px;">
                <div class="emoji">üöÄ</div>
                <h2 style="color: #2d3748; margin-bottom: 20px;">Bienvenido al Laboratorio</h2>
                <p style="color: #4a5568; line-height: 1.8; margin-bottom: 30px;">
                    En este laboratorio trabajar√°s con 5 ejercicios de diagn√≥stico de redes Docker.
                    Cada problema te mostrar√° s√≠ntomas, comandos de diagn√≥stico y finalmente
                    deber√°s encontrar la clave para desbloquear la soluci√≥n.
                </p>
                <div style="background: #f7fafc; padding: 20px; border-radius: 8px; text-align: left;">
                    <h3 style="color: #2d3748; margin-bottom: 15px;">üìã Preparaci√≥n del entorno:</h3>
                    <div class="code-block">
                        <span class="command"># Crear el entorno del laboratorio (cada linea es un comando separado)</span>
                        <br>git clone https://github.com/pablopedernera0/docker-connectivity-lab.git
                        <br>cd docker-connectivity-lab
                        <br>sh iniciar.sh
                    </div>
                </div>
            </div>
        </div>

        <!-- Ejercicio 1: Problema -->
        <div class="slide">
            <h2 class="problem-title">üî¥ Ejercicio 1: Red Aislada</h2>
            <p style="color: #4a5568; margin-bottom: 20px; font-size: 16px;">
                El contenedor <strong>container-b</strong> ha perdido conectividad con <strong>container-a</strong>.
                Los comandos b√°sicos de red no funcionan y no puede alcanzar ning√∫n otro contenedor.
            </p>

            <div class="step">
                <h3>üîß Simular el problema</h3>
                <div class="code-block">
                    <span class="command"># Preparar el problema 1</span>
                    sh problema-1.sh
                </div>
            </div>

            <div style="background: #fff5f5; padding: 20px; border-radius: 8px; border-left: 4px solid #fc8181;">
                <h3 style="color: #c53030; margin-bottom: 10px;">‚ö†Ô∏è S√≠ntomas observados:</h3>
                <ul style="color: #742a2a; padding-left: 20px;">
                    <li>Ping no funciona</li>
                    <li>No hay respuesta de red</li>
                    <li>El contenedor parece aislado</li>
                </ul>
            </div>
        </div>

        <!-- Ejercicio 1: Diagn√≥stico -->
        <div class="slide">
            <h2 class="diagnostic-title">üîç Ejercicio 1: Diagn√≥stico</h2>

            <div class="step">
                <h3>Paso 1: Intentar ping</h3>
                <div class="code-block">docker exec container-b ping -c 3 container-a</div>
                <p><strong>Resultado esperado:</strong> ping: bad address 'container-a'</p>
            </div>

            <div class="step">
                <h3>Paso 2: Verificar interfaces de red</h3>
                <div class="code-block">docker exec container-b ip addr show</div>
                <p><strong>Busca:</strong> ¬øQu√© interfaces aparecen? ¬øHay alguna eth0?</p>
            </div>

            <div class="step">
                <h3>Paso 3: Verificar redes del contenedor</h3>
                <div class="code-block">docker inspect container-b | grep -A 20 Networks</div>
                <p><strong>Busca:</strong> El campo "Networks" - ¬øest√° vac√≠o o tiene alguna red?</p>
            </div>

            <div class="questions">
                <h3>ü§î Preguntas para reflexionar:</h3>
                <ul>
                    <li>¬øPor qu√© falla el ping?</li>
                    <li>¬øQu√© interfaces de red tiene el contenedor?</li>
                    <li>¬øEst√° conectado a alguna red?</li>
                </ul>
            </div>
        </div>

        <!-- Ejercicio 2: Problema -->
        <div class="slide">
            <h2 class="problem-title">üî¥ Ejercicio 2: Problema de DNS</h2>
            <p style="color: #4a5568; margin-bottom: 20px; font-size: 16px;">
                Se cre√≥ un nuevo contenedor que no puede resolver nombres de otros contenedores,
                aunque la red est√° correctamente configurada.
            </p>

            <div class="step">
                <h3>üîß Simular el problema</h3>
                <div class="code-block">
                    <span class="command"># Preparar el problema 2</span>
                    <br>sh problema-2.sh
                </div>
            </div>

            <div style="background: #fff5f5; padding: 20px; border-radius: 8px; border-left: 4px solid #fc8181;">
                <h3 style="color: #c53030; margin-bottom: 10px;">‚ö†Ô∏è S√≠ntomas observados:</h3>
                <ul style="color: #742a2a; padding-left: 20px;">
                    <li>No resuelve nombres de contenedores</li>
                    <li>Ping por nombre falla</li>
                    <li>DNS parece no funcionar correctamente</li>
                </ul>
            </div>
        </div>

        <!-- Ejercicio 2: Diagn√≥stico -->
        <div class="slide">
            <h2 class="diagnostic-title">üîç Ejercicio 2: Diagn√≥stico</h2>

            <div class="step">
                <h3>Paso 1: Intentar conexi√≥n por nombre</h3>
                <div class="code-block">docker exec container-c ping -c 3 container-a</div>
                <p><strong>Resultado esperado:</strong> Puede fallar con "bad address" o timeout</p>
            </div>

            <div class="step">
                <h3>Paso 2: Verificar configuraci√≥n DNS</h3>
                <div class="code-block">docker exec container-c cat /etc/resolv.conf</div>
                <p><strong>Busca:</strong> La l√≠nea "nameserver" - ¬øqu√© direcci√≥n IP aparece?</p>
            </div>

            <div class="step">
                <h3>Paso 3: Probar resoluci√≥n DNS</h3>
                <div class="code-block">docker exec container-c nslookup container-a</div>
                <p><strong>Busca:</strong> ¬øEl servidor puede resolver el nombre?</p>
            </div>

            <div class="step">
                <h3>Paso 4: Obtener IP y probar conexi√≥n directa</h3>
                <div class="code-block">
                    <br>CONTAINER_A_IP=$(docker inspect -f '{{range.NetworkSettings.Networks}}{{.IPAddress}}{{end}}'
                    container-a)
                    <br>echo $CONTAINER_A_IP
                    <br>docker exec container-c ping -c 3 $CONTAINER_A_IP
                </div>
                <p><strong>Resultado esperado:</strong> El ping por IP deber√≠a funcionar</p>
            </div>

            <div class="questions">
                <h3>ü§î Preguntas para reflexionar:</h3>
                <ul>
                    <li>¬øFunciona el ping por IP pero no por nombre?</li>
                    <li>¬øQu√© servidor DNS est√° usando?</li>
                    <li>¬øPuede resolver nombres internos de Docker?</li>
                </ul>
            </div>
        </div>

        <!-- Ejercicio 3: Problema -->
        <div class="slide">
            <h2 class="problem-title">üî¥ Ejercicio 3: Puerto No Accesible</h2>
            <p style="color: #4a5568; margin-bottom: 20px; font-size: 16px;">
                Un servidor web est√° corriendo pero el cliente no puede acceder al servicio,
                aunque ambos est√°n en la misma red.
            </p>

            <div class="step">
                <h3>üîß Simular el problema</h3>
                <div class="code-block">
                    <span class="command"># Preparar el problema 3</span>
                    <br>sh problema-3.sh
                </div>
            </div>

            <div style="background: #fff5f5; padding: 20px; border-radius: 8px; border-left: 4px solid #fc8181;">
                <h3 style="color: #c53030; margin-bottom: 10px;">‚ö†Ô∏è S√≠ntomas observados:</h3>
                <ul style="color: #742a2a; padding-left: 20px;">
                    <li>Ping funciona pero curl no</li>
                    <li>Timeout al intentar conectar al puerto</li>
                    <li>El servidor parece estar corriendo</li>
                </ul>
            </div>
        </div>

        <!-- Ejercicio 3: Diagn√≥stico -->
        <div class="slide">
            <h2 class="diagnostic-title">üîç Ejercicio 3: Diagn√≥stico</h2>

            <div class="step">
                <h3>Paso 1: Verificar que el servidor est√° corriendo</h3>
                <div class="code-block">docker exec web-server ps aux | grep python</div>
                <p><strong>Busca:</strong> El proceso de Python en ejecuci√≥n</p>
            </div>

            <div class="step">
                <h3>Paso 2: Intentar conexi√≥n desde el cliente</h3>
                <div class="code-block">docker exec web-client curl http://web-server:8080</div>
                <p><strong>Resultado:</strong> Anota si funciona o da timeout</p>
            </div>

            <div class="step">
                <h3>Paso 3: Verificar conectividad b√°sica</h3>
                <div class="code-block">docker exec web-client ping -c 3 web-server</div>
                <p><strong>Resultado esperado:</strong> El ping deber√≠a funcionar</p>
            </div>

            <div class="step">
                <h3>Paso 4: Test de puerto espec√≠fico</h3>
                <div class="code-block">docker exec web-client nc -zv web-server 8080</div>
                <p><strong>Busca:</strong> El mensaje que indica si el puerto est√° abierto o cerrado</p>
            </div>

            <div class="step">
                <h3>Paso 5: Verificar en qu√© interfaz escucha el servidor</h3>
                <div class="code-block">docker exec web-server netstat -tlnp | grep 8080</div>
                <p><strong>Busca:</strong> La columna "Local Address" - ¬ødice 0.0.0.0:8080 o 127.0.0.1:8080?</p>
            </div>

            <div class="questions">
                <h3>ü§î Preguntas para reflexionar:</h3>
                <ul>
                    <li>¬øEl ping funciona pero curl no?</li>
                    <li>¬øEn qu√© interfaz est√° escuchando el servidor?</li>
                    <li>¬øDeber√≠a escuchar en localhost o en todas las interfaces?</li>
                </ul>
            </div>
        </div>

        <!-- Ejercicio 4: Problema -->
        <div class="slide">
            <h2 class="problem-title">üî¥ Ejercicio 4: Redes Diferentes</h2>
            <p style="color: #4a5568; margin-bottom: 20px; font-size: 16px;">
                Dos contenedores no pueden comunicarse entre s√≠, aunque ambos parecen
                estar correctamente configurados individualmente.
            </p>

            <div class="step">
                <h3>üîß Simular el problema</h3>
                <div class="code-block">
                    <span class="command"># Preparar el problema 4</span>
                    <br>sh problema-4.sh
                </div>
            </div>

            <div style="background: #fff5f5; padding: 20px; border-radius: 8px; border-left: 4px solid #fc8181;">
                <h3 style="color: #c53030; margin-bottom: 10px;">‚ö†Ô∏è S√≠ntomas observados:</h3>
                <ul style="color: #742a2a; padding-left: 20px;">
                    <li>No hay conectividad entre contenedores</li>
                    <li>Ambos contenedores funcionan individualmente</li>
                    <li>Ping no encuentra el host de destino</li>
                </ul>
            </div>
        </div>

        <!-- Ejercicio 4: Diagn√≥stico -->
        <div class="slide">
            <h2 class="diagnostic-title">üîç Ejercicio 4: Diagn√≥stico</h2>

            <div class="step">
                <h3>Paso 1: Intentar ping entre contenedores</h3>
                <div class="code-block">docker exec isolated-a ping -c 3 isolated-b</div>
                <p><strong>Resultado esperado:</strong> Deber√≠a fallar</p>
            </div>

            <div class="step">
                <h3>Paso 2: Verificar redes de isolated-a</h3>
                <div class="code-block">docker inspect isolated-a | grep -A 10 Networks</div>
                <p><strong>Busca:</strong> El nombre de la red a la que est√° conectado</p>
            </div>

            <div class="step">
                <h3>Paso 3: Verificar redes de isolated-b</h3>
                <div class="code-block">docker inspect isolated-b | grep -A 10 Networks</div>
                <p><strong>Busca:</strong> El nombre de la red a la que est√° conectado</p>
            </div>

            <div class="step">
                <h3>Paso 4: Listar todas las redes</h3>
                <div class="code-block">docker network ls</div>
                <p><strong>Busca:</strong> Las redes lab-network y lab-network-2</p>
            </div>

            <div class="step">
                <h3>Paso 5: Ver contenedores en cada red</h3>
                <div class="code-block">
                    <br>docker network inspect lab-network | grep Name
                    <br>docker network inspect lab-network-2 | grep Name
                </div>
                <p><strong>Busca:</strong> Qu√© contenedores est√°n en cada red</p>
            </div>

            <div class="questions">
                <h3>ü§î Preguntas para reflexionar:</h3>
                <ul>
                    <li>¬øEn qu√© redes est√° cada contenedor?</li>
                    <li>¬øPueden dos contenedores en redes diferentes comunicarse por defecto?</li>
                    <li>¬øC√≥mo podr√≠an comunicarse?</li>
                </ul>
            </div>
        </div>

        <!-- Ejercicio 5: Problema -->
        <div class="slide">
            <h2 class="problem-title">üî¥ Ejercicio 5: Firewall Bloqueando Tr√°fico</h2>
            <p style="color: #4a5568; margin-bottom: 20px; font-size: 16px;">
                Un contenedor no puede hacer ping a otros contenedores, pero otros protocolos
                parecen funcionar correctamente.
            </p>

            <div class="step">
                <h3>üîß Simular el problema</h3>
                <div class="code-block">
                    <span class="command"># Preparar el problema 5</span>
                    <br>sh problema-5.sh
                </div>
            </div>

            <div style="background: #fff5f5; padding: 20px; border-radius: 8px; border-left: 4px solid #fc8181;">
                <h3 style="color: #c53030; margin-bottom: 10px;">‚ö†Ô∏è S√≠ntomas observados:</h3>
                <ul style="color: #742a2a; padding-left: 20px;">
                    <li>Ping no funciona</li>
                    <li>Otros servicios (HTTP) s√≠ funcionan</li>
                    <li>Comportamiento selectivo seg√∫n el protocolo</li>
                </ul>
            </div>
        </div>

        <!-- Ejercicio 5: Diagn√≥stico -->
        <div class="slide">
            <h2 class="diagnostic-title">üîç Ejercicio 5: Diagn√≥stico</h2>

            <div class="step">
                <h3>Paso 1: Intentar ping (fallar√°)</h3>
                <div class="code-block">docker exec firewall-test ping -c 3 container-a</div>
                <p><strong>Resultado esperado:</strong> Deber√≠a fallar o timeout</p>
            </div>

            <div class="step">
                <h3>Paso 2: Verificar reglas iptables</h3>
                <div class="code-block">docker exec firewall-test iptables -L -n -v</div>
                <p><strong>Busca:</strong> La secci√≥n OUTPUT - ¬øhay alguna regla DROP para ICMP?</p>
            </div>

            <div class="step">
                <h3>Paso 3: Intentar con otro protocolo</h3>
                <div class="code-block">docker exec firewall-test curl http://container-a</div>
                <p><strong>Resultado esperado:</strong> Deber√≠a funcionar correctamente</p>
            </div>

            <div class="step">
                <h3>Paso 4: Ver estad√≠sticas de la regla</h3>
                <div class="code-block">docker exec firewall-test iptables -L OUTPUT -v</div>
                <p><strong>Busca:</strong> Los contadores de paquetes - ¬øcu√°ntos paquetes fueron bloqueados?</p>
            </div>

            <div class="questions">
                <h3>ü§î Preguntas para reflexionar:</h3>
                <ul>
                    <li>¬øPor qu√© curl funciona pero ping no?</li>
                    <li>¬øQu√© protocolo usa ping?</li>
                    <li>¬øQu√© reglas est√°n bloqueando tr√°fico?</li>
                </ul>
            </div>
        </div>

        <!-- Final -->
        <div class="slide">
            <div class="completion">
                <div class="emoji">üéâ</div>
                <h2>¬°Laboratorio Completado!</h2>
                <p>Has diagnosticado y resuelto 5 problemas comunes de conectividad en Docker.</p>
                <p style="margin-top: 20px;">Recuerda siempre seguir una metodolog√≠a sistem√°tica de diagn√≥stico:</p>
                <div style="background: #f7fafc; padding: 30px; border-radius: 8px; margin-top: 30px; text-align: left;">
                    <ul style="color: #2d3748; line-height: 2;">
                        <li>‚úÖ Verificar conectividad b√°sica (ping)</li>
                        <li>‚úÖ Revisar configuraci√≥n de red</li>
                        <li>‚úÖ Comprobar DNS</li>
                        <li>‚úÖ Verificar puertos y servicios</li>
                        <li>‚úÖ Revisar reglas de firewall</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div style="padding: 30px; background: #f7fafc;">
        <div class="navigation">
            <button class="btn btn-prev" id="prevBtn" onclick="changeSlide(-1)">‚Üê Anterior</button>
            <button class="btn btn-next" id="nextBtn" onclick="changeSlide(1)">Siguiente ‚Üí</button>
            <button class="btn btn-solve" id="solveBtn" onclick="showSolveModal()" style="display: none;">üîì Resolver
            </button>
        </div>
    </div>
</div>

<!-- Modal para ingresar soluci√≥n -->
<div class="modal" id="solveModal">
    <div class="modal-content">
        <div class="modal-header">
            <span style="font-size: 32px;">üîê</span>
            <h2>Desbloquear Soluci√≥n</h2>
        </div>

        <p style="color: #4a5568; margin-bottom: 20px;">
            Para desbloquear la soluci√≥n, ingresa la clave que encontraste en el diagn√≥stico.
        </p>

        <div class="hints" id="hintsContainer"></div>

        <div class="input-group">
            <label for="solutionKey">Clave de soluci√≥n:</label>
            <input type="text" id="solutionKey" placeholder="Ingresa la clave aqu√≠...">
        </div>

        <div class="error-message" id="errorMessage">
            ‚ùå Clave incorrecta. Revisa las pistas y vuelve a intentar.
        </div>

        <div style="display: flex; gap: 15px; margin-top: 25px;">
            <button class="btn btn-prev" onclick="closeSolveModal()" style="flex: 1;">Cancelar</button>
            <button class="btn btn-solve" onclick="checkSolution()" style="flex: 1;">Verificar</button>
        </div>
    </div>
</div>

<!-- Modal para mostrar soluci√≥n -->
<div class="modal" id="solutionModal">
    <div class="modal-content">
        <div class="modal-header">
            <span style="font-size: 32px;">‚úÖ</span>
            <h2>¬°Soluci√≥n Correcta!</h2>
        </div>

        <span class="success-badge">Problema Resuelto</span>

        <div class="solution-content" id="solutionContent"></div>

        <button class="btn btn-next" onclick="closeSolutionModal()" style="width: 100%; margin-top: 25px;">
            Continuar ‚Üí
        </button>
    </div>
</div>

<script>
    let currentSlide = 0;
    let currentExercise = 0;

    const exercises = [
        {
            problemSlide: 1,
            diagnosticSlide: 2,
            key: "lab-network",
            hints: [
                "üí° Busca el nombre de la red en el comando 'docker inspect'",
                "üí° F√≠jate en el campo 'Networks' del contenedor",
                "üí° La respuesta est√° vac√≠a {} porque no est√° conectado a ninguna red"
            ],
            hintText: "La clave es el nombre de la red de la que fue desconectado el contenedor.",
            solution: {
                title: "Problema: Contenedor Desconectado de la Red",
                description: "El contenedor fue desconectado de la red lab-network, por lo que perdi√≥ toda conectividad. Un contenedor sin red no puede comunicarse con otros contenedores ni resolver nombres DNS.",
                command: "docker network connect lab-network container-b"
            }
        },
        {
            problemSlide: 3,
            diagnosticSlide: 4,
            key: "1.1.1.1",
            hints: [
                "üí° Ejecuta 'docker exec container-c cat /etc/resolv.conf'",
                "üí° Busca la l√≠nea que comienza con 'nameserver'",
                "üí° Es una direcci√≥n IP p√∫blica conocida de Cloudflare"
            ],
            hintText: "La clave es la direcci√≥n IP del servidor DNS configurado (vista en /etc/resolv.conf).",
            solution: {
                title: "Problema: DNS Externo en Lugar de DNS Interno",
                description: "El contenedor fue configurado con un DNS externo (1.1.1.1) que no puede resolver nombres internos de Docker. Docker proporciona su propio servidor DNS que conoce los nombres de los contenedores en la misma red.",
                command: "docker rm -f container-c\ndocker run -d --name container-c --network lab-network alpine:latest sleep 3600"
            }
        },
        {
            problemSlide: 5,
            diagnosticSlide: 6,
            key: "127.0.0.1",
            hints: [
                "üí° Ejecuta 'docker exec web-server netstat -tlnp | grep 8080'",
                "üí° Mira la columna 'Local Address'",
                "üí° Si dice 127.0.0.1:8080, solo escucha en localhost"
            ],
            hintText: "La clave es la direcci√≥n IP en la que est√° escuchando el servidor (columna Local Address).",
            solution: {
                title: "Problema: Servidor Escuchando Solo en Localhost",
                description: "El servidor Python estaba escuchando en 127.0.0.1 (localhost) en lugar de 0.0.0.0 (todas las interfaces). Esto significa que solo acepta conexiones desde dentro del mismo contenedor, no desde otros contenedores de la red.",
                command: "# Recrear el servidor escuchando en todas las interfaces\n" +
                    "   docker rm -f web-server\n" +
                    "   docker run -d --name web-server \\\n" +
                    "     --network lab-network \\\n" +
                    "     python:3.9-alpine sh -c \"echo 'Hello World' > index.html && python -m http.server 8080\""
            }
        },
        {
            problemSlide: 7,
            diagnosticSlide: 8,
            key: "lab-network-2",
            hints: [
                "üí° Ejecuta 'docker inspect isolated-b | grep -A 10 Networks'",
                "üí° Busca el nombre de la red en la salida",
                "üí° Es diferente a 'lab-network'"
            ],
            hintText: "La clave es el nombre de la segunda red (donde est√° isolated-b).",
            solution: {
                title: "Problema: Contenedores en Redes Diferentes",
                description: "Los contenedores est√°n en redes Docker diferentes (lab-network y lab-network-2). Por defecto, los contenedores solo pueden comunicarse con otros contenedores en la misma red. Es necesario conectar un contenedor a ambas redes o moverlos a la misma red.",
                command: "docker network connect lab-network-2 isolated-a\n# Ahora isolated-a est√° en ambas redes y puede comunicarse con isolated-b"
            }
        },
        {
            problemSlide: 9,
            diagnosticSlide: 10,
            key: "icmp",
            hints: [
                "üí° Ejecuta 'docker exec firewall-test iptables -L OUTPUT -n -v'",
                "üí° Busca una regla que tenga 'DROP' en la columna 'target'",
                "üí° Mira la columna 'prot' (protocolo) - es el protocolo usado por ping"
            ],
            hintText: "La clave es el nombre del protocolo bloqueado por iptables (en min√∫sculas).",
            solution: {
                title: "Problema: Regla de Firewall Bloqueando ICMP",
                description: "Se agreg√≥ una regla de iptables que bloquea todo el tr√°fico ICMP saliente. ICMP es el protocolo usado por ping, por eso ping falla mientras que otros protocolos como HTTP (usado por curl) siguen funcionando. Las reglas de firewall pueden bloquear selectivamente diferentes tipos de tr√°fico.",
                command: "docker exec firewall-test iptables -D OUTPUT -p icmp -j DROP\n# Esto elimina la regla que bloquea ICMP"
            }
        }
    ];

    function updateProgress() {
        const totalSlides = document.querySelectorAll('.slide').length;
        const progress = ((currentSlide) / (totalSlides - 1)) * 100;
        document.getElementById('progressBar').style.width = progress + '%';
    }

    function showSlide(n) {
        const slides = document.querySelectorAll('.slide');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const solveBtn = document.getElementById('solveBtn');

        if (n >= slides.length) {
            currentSlide = slides.length - 1;
            return;
        }
        if (n < 0) {
            currentSlide = 0;
            return;
        }

        currentSlide = n;

        slides.forEach(slide => slide.classList.remove('active'));
        slides[currentSlide].classList.add('active');

        // Control de botones
        prevBtn.disabled = currentSlide === 0;
        nextBtn.style.display = currentSlide === slides.length - 1 ? 'none' : 'flex';

        // Mostrar bot√≥n resolver solo en slides de diagn√≥stico
        const isDiagnosticSlide = exercises.some(ex => ex.diagnosticSlide === currentSlide);
        solveBtn.style.display = isDiagnosticSlide ? 'flex' : 'none';

        // Actualizar ejercicio actual
        exercises.forEach((ex, idx) => {
            if (ex.diagnosticSlide === currentSlide) {
                currentExercise = idx;
            }
        });

        updateProgress();
        window.scrollTo(0, 0);
    }

    function changeSlide(direction) {
        showSlide(currentSlide + direction);
    }

    function showSolveModal() {
        const modal = document.getElementById('solveModal');
        const hintsContainer = document.getElementById('hintsContainer');
        const exercise = exercises[currentExercise];

        let hintsHTML = '<h4>üí° Pistas:</h4>';
        exercise.hints.forEach(hint => {
            hintsHTML += `<p>${hint}</p>`;
        });
        hintsHTML += `<p style="margin-top: 15px; font-weight: 600;">${exercise.hintText}</p>`;

        hintsContainer.innerHTML = hintsHTML;
        document.getElementById('solutionKey').value = '';
        document.getElementById('errorMessage').classList.remove('show');

        modal.classList.add('active');
    }

    function closeSolveModal() {
        document.getElementById('solveModal').classList.remove('active');
    }

    function checkSolution() {
        const input = document.getElementById('solutionKey').value.trim();
        const exercise = exercises[currentExercise];
        const errorMessage = document.getElementById('errorMessage');

        if (input.toLowerCase() === exercise.key.toLowerCase()) {
            closeSolveModal();
            showSolutionModal();
        } else {
            errorMessage.classList.add('show');
            setTimeout(() => {
                errorMessage.classList.remove('show');
            }, 3000);
        }
    }

    function showSolutionModal() {
        const modal = document.getElementById('solutionModal');
        const content = document.getElementById('solutionContent');
        const exercise = exercises[currentExercise];
        const solution = exercise.solution;

        content.innerHTML = `
                <h3>${solution.title}</h3>
                <p>${solution.description}</p>
                <div style="margin-top: 20px;">
                    <h4 style="color: #2d3748; margin-bottom: 10px;">üîß Comando de soluci√≥n:</h4>
                    <div class="code-block">${solution.command.replace(/\n/g, '<br>')}</div>
                </div>
            `;

        modal.classList.add('active');
    }

    function closeSolutionModal() {
        document.getElementById('solutionModal').classList.remove('active');
        // Avanzar autom√°ticamente a la siguiente slide
        changeSlide(1);
    }

    // Cerrar modales al hacer clic fuera
    window.onclick = function (event) {
        const solveModal = document.getElementById('solveModal');
        const solutionModal = document.getElementById('solutionModal');

        if (event.target === solveModal) {
            closeSolveModal();
        }
        if (event.target === solutionModal) {
            closeSolutionModal();
        }
    }

    // Permitir Enter para verificar soluci√≥n
    document.getElementById('solutionKey').addEventListener('keypress', function (event) {
        if (event.key === 'Enter') {
            checkSolution();
        }
    });

    // Inicializar
    showSlide(0);
</script>
</body>
</html>